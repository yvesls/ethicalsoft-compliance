<section class="reset-password">
	<header class="reset-password__header">
		<h1>Trocar senha</h1>
		<p>Defina uma nova senha forte para manter sua conta segura.</p>
	</header>

	<form class="reset-password__form" [formGroup]="form" (ngSubmit)="resetPassword()">
		<app-input
			formControlName="currentPassword"
			label="Senha atual"
			type="password"
			placeholder="Informe sua senha atual"
			[validationMessages]="currentPasswordValidationMessages"
			[control]="form.get('currentPassword')"
		></app-input>

		<app-input
			formControlName="newPassword"
			label="Nova senha"
			type="password"
			placeholder="Informe a nova senha"
			[validationMessages]="passwordValidationMessages"
			[control]="form.get('newPassword')"
		></app-input>

		<app-input
			formControlName="confirmPassword"
			label="Confirme a nova senha"
			type="password"
			placeholder="Repita a nova senha"
			[validationMessages]="confirmPasswordValidationMessages"
			[control]="form.get('confirmPassword')"
		></app-input>

		<div class="reset-password__tips">
			<p><strong>Dicas de segurança</strong></p>
			<ul>
				<li>Use letras maiúsculas e minúsculas.</li>
				<li>Inclua números e caracteres especiais.</li>
				<li>Evite informações pessoais fáceis de prever.</li>
			</ul>
		</div>

		<label class="reset-password__terms">
			<input type="checkbox" formControlName="acceptedTerms" />
			<span>
				Eu li e aceito os
				<button type="button" class="link" (click)="openTerms($event)">Termos de Uso</button>
				e Políticas de Privacidade.
			</span>
		</label>
		@if (form.get('acceptedTerms')?.invalid && form.get('acceptedTerms')?.touched) {
			<div class="reset-password__error">É necessário aceitar os termos e condições.</div>
		}

		<div class="reset-password__actions">
			<a class="btn btn-link" routerLink="/settings">Cancelar</a>
			<button class="btn btn-primary" type="submit" [disabled]="form.invalid || isSubmitting">
				{{ isSubmitting ? 'Salvando…' : 'Atualizar senha' }}
			</button>
		</div>
	</form>
</section>
